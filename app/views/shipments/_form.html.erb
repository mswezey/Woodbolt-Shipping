<style>
.col-left, .col-right {
	float:left;
	width:400px;
}
.col-left-small, .col-right-small {
	float:left;
	width:300px;
}
</style>
<% form_for @shipment do |f| %>
  <%= f.error_messages %>
<div class="col-left">
	<p>
    <%= f.label :comments %><br />
    <%= f.text_area :comments, :rows => 10 %>
  </p>
</div>

<div class="col-left">
	<p>
    <%= f.label :submitter_id, "Submitter" %><br />
    <%= current_user.name %>
  </p>
  <p>
    <%= f.label :assigned_to_id, "Assigned To" %><br />
    <%= f.select :assigned_to_id, User.all.collect {|u| [u.name, u.id]} %>
  </p>
  <p>
    <%= f.label :state, "Status" %><br />
    <%= f.select :state, %w[pending delivered invoiced] %>
  </p>
</div>

<br clear="all" />

<div class="col-left">
	<p>
    <%= f.label :bol_date, "Bill of Lading Date" %><br />
    <%= f.date_select :bol_date, :prompt => true %>
  </p>
	<p>
    <%= f.label :bol, "Attach Bill of Lading" %><br />
    <%= f.file_field :bol %>
  </p>
  <p>
		<%= f.label :carrier_id %> <a class='new-carrier' href='#' rel='shipper'>Add New</a><br />
	  <%= f.select :carrier_id, Carrier.all.collect {|u| [u.name, u.id]}, :prompt => 'Choose Carrier' %>
  </p>
  <p>
    <%= f.label :invoiced_by_id %><br />
    <%= f.select :invoiced_by_id, User.all.collect {|u| [u.name, u.id]}, :include_blank => true %>
  </p>
  <p>
    <%= f.label :bol_pro_number %><br />
    <%= f.text_field :bol_pro_number %>
  </p>
</div>

<div class="col-right">
	<p>
    <%= f.label :scheduled_pickup %><br />
    <%= f.date_select :scheduled_pickup, :prompt => true, :start_year => Date.today.year %>
  </p>
  <p>
    <%= f.label :scheduled_by_id %><br />
    <%= f.select :scheduled_by_id, User.all.collect {|u| [u.name, u.id]}, :include_blank => true %>
  </p>
  <p>
    <%= f.label :bill_to_id %> <a class='new-contact' href='#'>Add New</a><br />
    <%= f.select :bill_to_id, Contact.all.collect {|u| [u.name, u.id]}, :include_blank => true %>
  </p>
  <p>
    <%= f.label :ship_date, "Deliver By ?" %><br />
    <%= f.date_select :ship_date, :prompt => true, :start_year => Date.today.year %>
  </p>
  <p>
    <%= f.label :picked_up_at %><br />
    <%= f.datetime_select :picked_up_at, :prompt => true, :start_year => Date.today.year %>
  </p>
</div>

<br clear="all" />

<div class="col-left">
	<p>
	  <%= f.label :shipper_id %> <a class='new-contact' href='#' rel='shipper'>Add New</a><br />
	  <%= f.select :shipper_id, Contact.shippers.collect {|u| [u.name, u.id]}, :include_blank => true %>
	</p>
</div>

<div class="col-right">
	<p>
	  <%= f.label :consignee_id %> <a class='new-contact' href='#' rel='consignee'>Add New</a><br />
	  <%= f.select :consignee_id, Contact.consignees.collect {|u| [u.name, u.id]}, :include_blank => true %>
	</p>
</div>

<br clear="all" />

<div class="col-left">
  <p>
    <%= f.label :reference_number %><br />
    <%= f.text_field :reference_number %>
  </p>
	<p>
    <%= f.label :packing_list, "Attach Packing List" %><br />
    <%= f.file_field :packing_list %>
  </p>
  <p>
    <%= f.label :pallet_qty, "Pallets" %><br />
    <%= f.text_field :pallet_qty %>
  </p>
  <p>
    <%= f.label :pallet_dimentions %><br />
    <%= f.text_field :pallet_dimentions %>
  </p>
  <p>
    <%= f.label :weight %><br />
    <%= f.text_field :weight %>
  </p>
</div>

<div class="col-right">
  <p>
    <%= f.label :carrier_invoice_number %><br />
    <%= f.text_field :carrier_invoice_number %>
  </p>
  <p>
    <%= f.label :classification_id %><br />
    <%= f.select :classification_id, Shipment::CLASSIFICATION_TYPE_ID.sort %>
  </p>
</div>

<br clear="all" />

  <p><%= f.submit "Submit" %></p>

<% end %>

<div id="new-carrier">
	<% form_for :carrier, :url => carriers_path, :html => {:id => "new-carrier-form"} do |f| %>
	  <%= f.error_messages %>
	  <p>
	    <%= f.label :name %><br />
	    <%= f.text_field :name %>
	  </p>
	  <p><%= f.submit "Submit" %></p>
	<% end %>
</div>

<div id="new-contact">
	<% form_for :contact, :url => contacts_path, :html => {:id => "new-contact-form"} do |f| %>
	  <%= f.error_messages %>
	  <p>
	    <%= f.label :contact_type_id %><br />
	    <%= f.select :contact_type_id, Contact::CONTACT_TYPE_ID.map {|c| [c[0].humanize, c[1]]}.sort, :prompt => 'Select Contact Type' %>
	  </p>
	<div class='col-left-small'>
	  <p>
	    <%= f.label :first_name %><br />
	    <%= f.text_field :first_name %>
	  </p>
	  <p>
	    <%= f.label :last_name %><br />
	    <%= f.text_field :last_name %>
	  </p>
	  <p>
	    <%= f.label :email %><br />
	    <%= f.text_field :email %>
	  </p>
	</div>
	<div class='col-right-small'>
	  <p>
	    <%= f.label :street_1 %><br />
	    <%= f.text_field :street_1 %>
	  </p>
	  <p>
	    <%= f.label :street_2 %><br />
	    <%= f.text_field :street_2 %>
	  </p>
	  <p>
	    <%= f.label :city %><br />
	    <%= f.text_field :city %>
	  </p>
	  <p>
	    <%= f.label :state %><br />
	    <%= f.text_field :state %>
	  </p>
	  <p>
	    <%= f.label :zip %><br />
	    <%= f.text_field :zip %>
	  </p>
	  <p>
	    <%= f.label :phone %><br />
	    <%= f.text_field :phone %>
	  </p>
	  <p>
	    <%= f.label :fax %><br />
	    <%= f.text_field :fax %>
	  </p>
	</div>
	<br clear="all" />
	  <p><%= f.submit "Submit" %></p>
	<% end %>
</div>

<script>
$(function(){
	$("#new-carrier").dialog({ autoOpen: false, width : '300px', title : "New Carrier" });
	$(".new-carrier").click(function(){
		$("#new-carrier").dialog('open');
		return false;
	});
	$("#new-carrier-form").submit(function(){
		$.post($(this).attr('action'), $(this).serialize(), null, "script");
    return false;
	});
	
	$("#new-contact").dialog({ autoOpen: false, width : '660px', title : "New Contact" });
	$(".new-contact").click(function(){
		switch( $(this).attr("rel") )
		{
		case "shipper":
		 var newContactValue =  1;
		  break;
		case "consignee":
		 var newContactValue =  2;
		  break;
		case "third_party":
		 var newContactValue =  3;
		  break;
		default:
		 var newContactValue =  '';
		}
		$("#contact_contact_type_id").val(newContactValue);
		$("#new-contact").dialog('open');
		return false;
	});
	$("#new-contact-form").submit(function(){
		$.post($(this).attr('action'), $(this).serialize(), null, "script");
    return false;
	});
});
</script>